
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Borne photo</title>
    <link rel="icon" type="image/png" href="/static/favicon.png">
    <link rel="stylesheet" href="/static/css/client_base.css?v=4">
    <link rel="stylesheet" href="/static/css/client_online.css?v=1">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <!-- Desktop: Logo à gauche -->
                <div class="logo-container desktop-only" style="display: flex; align-items: center; flex-shrink: 0; cursor: pointer;" onclick="window.location.href='https://photoslesgarennes.com'">
                    <img src="/static/logo/Photo Les Garennes.png" alt="Photos Les Garennes" class="logo" style="height: 50px; filter: brightness(1.1);">
                </div>
                
                <!-- Mobile: Menu burger à gauche -->
                <button id="mobile-menu-btn" class="mobile-only" style="display: none; background: none; border: none; color: white; font-size: 24px; cursor: pointer; padding: 8px; flex-shrink: 0;">
                    ☰
                </button>
                
                <!-- Centre: Dropdown événement + Barre de recherche (mobile et desktop) -->
                <div class="header-center" style="flex: 1; display: flex; align-items: center; gap: 10px; padding: 0 15px; justify-content: center;">
                    <!-- Dropdown événement (mobile uniquement, plus étroit) -->
                    <div id="event-filter-header-mobile" class="mobile-only" style="display: none; flex-shrink: 0;">
                        <select id="event-filter-header" style="width: 80px; background: white; border: none; border-radius: 6px; padding: 6px 8px; font-size: 0.85em; color: #2d3561; cursor: pointer;">
                            <option value="all" selected>Tous</option>
                        </select>
                    </div>
                    
                    <!-- Dropdown événement (desktop uniquement) -->
                    <div id="event-filter-header-desktop" class="desktop-only" style="display: flex; align-items: center; flex-shrink: 0;">
                        <label for="event-filter-desktop" style="color: white; font-size: 0.9em; font-weight: 600; margin-right: 8px; white-space: nowrap;">Événement:</label>
                        <select id="event-filter-desktop" style="background: white; border: none; border-radius: 6px; padding: 8px 12px; font-size: 0.9em; color: #2d3561; cursor: pointer; min-width: 150px;">
                            <option value="all" selected>Tous</option>
                        </select>
                    </div>
                    
                    <!-- Barre de recherche -->
                    <div class="search-box header-search-box" style="width: 100%; max-width: 560px; margin-bottom: 0;">
                        <input type="text" id="photo-search" data-i18n-placeholder="search_placeholder" placeholder="Rechercher par nom de cavalier ou cheval (ex: Jappeloup)" autocomplete="off">
                        <div id="suggestions-box"></div>
                    </div>
                </div>
                
                <!-- Desktop: Boutons à droite -->
                <div class="header-right desktop-only" style="display: flex; align-items: center; gap: 12px; flex-shrink: 0;">
                    <!-- Code panier -->
                    <div class="cart-code-search-box" style="display: flex; align-items: center;">
                        <input type="text" id="cart-code-search" data-i18n-placeholder="cart_code_placeholder" placeholder="Code panier" autocomplete="off" maxlength="4" onkeypress="if(event.key === 'Enter') loadSavedCart();" style="width: 126px; padding: 10px 12px; border: none; border-radius: 999px; background: white; color: #2d3561; outline: none; box-shadow: 0 2px 8px rgba(0,0,0,0.18); font-family: inherit;">
                    </div>
                    
                    <!-- Bouton Panier -->
                    <button id="cart-header-btn" onclick="toggleCart()" style="display: inline-flex; align-items: center; gap: 8px; padding: 8px 18px; background: white; color: #2d3561; border: none; border-radius: 999px; cursor: pointer; font-size: 0.95em; font-weight: 600; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">
                        <span data-i18n="cart_title">Panier</span>
                        <span id="cart-count-header" style="background: #667eea; color: white; padding: 2px 8px; border-radius: 999px; font-size: 0.8em; min-width: 20px; text-align: center; display: none;">0</span>
                    </button>
                    
                    <!-- Sélecteur de langue -->
                    <div style="display: flex; gap: 5px; background: rgba(255,255,255,0.1); border-radius: 8px; padding: 2px;">
                        <button class="lang-btn active" data-lang="fr" style="padding: 8px 15px; background: transparent; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s;">FR</button>
                        <button class="lang-btn" data-lang="en" style="padding: 8px 15px; background: transparent; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s;">EN</button>
                        <button class="lang-btn" data-lang="es" style="padding: 8px 15px; background: transparent; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s;">ES</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Menu mobile (burger) -->
        <div id="mobile-menu" class="mobile-menu" style="display: none;">
            <div class="mobile-menu-content">
                <button class="mobile-menu-close" style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: white; font-size: 28px; cursor: pointer; padding: 5px;">×</button>
                <!-- Logo en haut à gauche -->
                <div class="mobile-menu-logo" style="padding: 15px 20px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); cursor: pointer;" onclick="window.location.href='https://photoslesgarennes.com'">
                    <img src="/static/logo/Photo Les Garennes.png" alt="Photos Les Garennes" class="logo" style="height: 40px; filter: brightness(1.1);">
                </div>
                <div class="mobile-menu-items">
                    <button class="mobile-menu-item" data-action="promotions">Nos offres</button>
                    <div class="mobile-menu-item" style="padding: 15px 20px;">
                        <label style="color: white; font-size: 0.9em; display: block; margin-bottom: 8px;" data-i18n="cart_code_placeholder">Code panier</label>
                        <input type="text" id="cart-code-search-mobile" placeholder="Code panier" autocomplete="off" maxlength="4" style="width: 100%; padding: 10px; border: none; border-radius: 6px; background: white; color: #2d3561; outline: none;">
                    </div>
                    <button class="mobile-menu-item" data-action="tutorial">Voir tuto</button>
                    <div class="mobile-menu-item" style="padding: 15px 20px;">
                        <label style="color: white; font-size: 0.9em; display: block; margin-bottom: 8px;">Langue</label>
                        <select id="mobile-lang-select-menu" style="width: 100%; padding: 10px; border: none; border-radius: 6px; background: white; color: #2d3561; cursor: pointer;">
                            <option value="fr" selected>Français</option>
                            <option value="en">English</option>
                            <option value="es">Español</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="content">
            <div id="message" class="message"></div>
            
            <!-- Layout en 3 colonnes : Promotions (gauche), Recherche (milieu), Tutoriel (droite) -->
            <div class="main-layout">
                <!-- Colonne gauche : Promotions -->
                <div class="left-column" id="left-column">
                    <div class="promotions-section">
                        <div style="display: flex; justify-content: center; align-items: center; position: relative;">
                            <h2 data-i18n="promotions_title" style="margin: 0; text-align: center; flex: 1;">Nos offres</h2>
                            <button class="toggle-column-btn" data-column="left" title="Réduire/Aggrandir" style="background: none; border: none; font-size: 1.5em; cursor: pointer; color: #2d3561; padding: 0 10px; position: absolute; right: 0;">−</button>
                        </div>
                        <div class="collapsed-label" data-i18n="view_promotions">+ Nos offres</div>
                        <div id="promotions-list" class="promotions-list"></div>
                    </div>
                </div>
                
                <!-- Colonne centrale : Recherche et contenu principal -->
                <div class="center-column">
                    <button type="button" id="pack-btn" class="btn pack-btn" data-i18n="buy_pack_btn" style="width: auto; padding: 12px 30px; background: #2d3561; color: #fff; border: none; border-radius: 8px; font-weight: 600; margin-bottom: 15px;">Acheter mon pack</button>
                    <!-- Conteneur de résultats de photos -->
                    <div id="photos-results" style="display: none;"></div>
                    
                    <!-- Lightbox pour affichage en grand -->
                    <div id="lightbox" class="lightbox">
                        <button id="lightbox-add-btn" class="lightbox-add-btn" data-i18n="add_to_cart_btn">Ajouter au panier</button>
                        <span class="lightbox-close">&times;</span>
                        <div id="lightbox-prev" class="lightbox-nav prev">‹</div>
                        <div id="lightbox-next" class="lightbox-nav next">›</div>
                        <div class="lightbox-image-container">
                            <img id="lightbox-img" class="lightbox-content" src="" alt="">
                        </div>
                        <div id="lightbox-caption" class="lightbox-caption"></div>
                    </div>
                </div>
                
                <!-- Colonne droite : Tutoriel -->
                <div class="right-column" id="right-column">
                    <div class="tutorial-section">
                        <div style="display: flex; justify-content: center; align-items: center; position: relative;">
                            <h2 data-i18n="tutorial_title" style="margin: 0; text-align: center; flex: 1;">Comment utiliser la borne</h2>
                            <button class="toggle-column-btn" data-column="right" title="Réduire/Aggrandir" style="background: none; border: none; font-size: 1.5em; cursor: pointer; color: #2d3561; padding: 0 10px; position: absolute; right: 0;">−</button>
                        </div>
                        <div class="collapsed-label" data-i18n="view_tutorial">Voir tuto</div>
                        <div id="tutorial-content" class="tutorial-content"></div>
                    </div>
                </div>
            </div>
            
            <!-- Popup Panier (overlay central) -->
            <div id="cart-modal" class="cart-modal">
                <div class="cart-modal-dialog">
            <div class="cart">
                        <div class="cart-header">
                            <h2 data-i18n="cart_title" style="margin: 0; text-align: center; flex: 1;">Panier</h2>
                            <button onclick="toggleCart()" style="background: none; border: none; color: white; font-size: 32px; cursor: pointer; padding: 0; line-height: 1; position: absolute; top: 15px; right: 15px; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">&times;</button>
                        </div>
                        <div id="cart-content">
                            <div class="cart-two-columns">
                                <div class="cart-left-column">
                <div id="cart-items"></div>
                                </div>
                                <div class="cart-right-column">
                                    <div class="cart-summary">
                                        <h3 data-i18n="summary_title">Récapitulatif</h3>
                                        <div id="cart-summary-details"></div>
                                        <div class="summary-line">
                                            <span data-i18n="total_label">Total</span>
                                            <span id="cart-total" class="summary-total">0.00</span> €
                                        </div>
                                        <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 15px;">
                                            <button type="button" id="cancel-order-btn" class="btn btn-cancel" data-i18n="cancel_order_btn" style="padding: 12px; background: #ef4444; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; display: none;">Annuler la commande</button>
                                            <button type="button" id="validate-cart-btn" class="btn" data-i18n="submit_order_btn" style="padding: 12px; background: #10b981; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; display: none;">Valider ma commande</button>
                                            <button type="button" id="save-cart-btn" class="btn" data-i18n="save_cart_btn" style="padding: 12px; background: #6b7280; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; display: none;">Finaliser plus tard</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Popup Code Panier Sauvegardé -->
            <div id="saved-cart-code-modal" class="cart-modal">
                <div class="cart-modal-dialog" style="max-width: 500px;">
                    <div class="cart">
                        <div class="cart-header">
                            <h2 style="margin: 0;" data-i18n="saved_cart_title">Panier sauvegardé</h2>
                            <button onclick="document.getElementById('saved-cart-code-modal').classList.remove('active'); location.reload();" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">&times;</button>
                        </div>
                        <div style="padding: 30px; text-align: center;">
                            <p style="font-size: 1.1em; margin-bottom: 20px;" data-i18n="saved_cart_success">Votre panier a été sauvegardé avec succès !</p>
                            <div style="background: #f3f4f6; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                                <p style="margin: 0 0 10px 0; color: #6b7280; font-size: 0.9em;" data-i18n="saved_cart_recovery_code">Code de récupération :</p>
                                <p id="saved-cart-code-display" style="margin: 0; font-size: 2.5em; font-weight: bold; color: #2d3561; letter-spacing: 0.1em;">0000</p>
                            </div>
                            <p style="font-size: 0.9em; color: #6b7280; margin-bottom: 20px;" data-i18n="saved_cart_note">Notez ce code pour récupérer votre panier plus tard.</p>
                            <button onclick="document.getElementById('saved-cart-code-modal').classList.remove('active'); location.reload();" style="padding: 12px 30px; background: #2d3561; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; font-weight: 600;" data-i18n="close_btn">Fermer</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Popup Informations Personnelles -->
            <div id="order-info-modal" class="cart-modal">
                <div class="cart-modal-dialog" style="max-width: 800px;">
                    <div class="cart">
                        <div class="cart-header">
            <h2 data-i18n="personal_info_title">Informations personnelles</h2>
                            <button onclick="document.getElementById('order-info-modal').classList.remove('active')" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">&times;</button>
                        </div>
                        <div style="padding: 20px; overflow-y: auto; max-height: 70vh;">
            <form id="order-form">
                <div class="form-group">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                        <div>
                                            <label data-i18n="last_name_label">Nom *</label>
                                            <input type="text" id="client-lastname" data-i18n-placeholder="last_name_placeholder" placeholder="Nom" autocomplete="off" required>
                                        </div>
                                        <div>
                                            <label data-i18n="first_name_label">Prénom *</label>
                                            <input type="text" id="client-firstname" data-i18n-placeholder="first_name_placeholder" placeholder="Prénom" autocomplete="off" required>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label id="email-label">Email<span id="email-required-indicator"></span></label>
                                    <input type="email" id="client-email" placeholder="Email" autocomplete="off">
                                </div>
                                <div class="form-group">
                                    <label data-i18n="phone_label">Téléphone *</label>
                                    <input type="tel" id="client-phone" data-i18n-placeholder="phone_placeholder" autocomplete="off" required>
                                </div>
                                
                                <!-- Champ adresse (affiché dynamiquement si un produit le nécessite) -->
                                <div id="client-address-group" style="display: none;">
                                    <div class="form-group">
                                        <label data-i18n="postal_address_label">Adresse postale *</label>
                                        <textarea id="client-address" rows="2" data-i18n-placeholder="postal_address_placeholder" placeholder="Votre adresse" autocomplete="off"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                            <div>
                                                <label data-i18n="postal_code_label">Code Postal *</label>
                                                <input type="text" id="client-zip" data-i18n-placeholder="postal_code_placeholder" placeholder="CP" autocomplete="off">
                                            </div>
                                            <div>
                                                <label data-i18n="city_label">Ville *</label>
                                                <input type="text" id="client-city" placeholder="Ville" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Client professionnel -->
                                <div class="form-group" style="margin-top: 20px; padding: 15px; background: #f0f7ff; border-radius: 8px; border: 1px solid #2d3561;">
                                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; font-weight: 600; color: #2d3561;">
                                        <input type="checkbox" id="is-professional" autocomplete="off" style="width: 20px; height: 20px; cursor: pointer;">
                                        <span data-i18n="pro_client_label">Client professionnel (Je veux une facture)</span>
                                    </label>
                                    
                                    <!-- Champs conditionnels pour client pro -->
                                    <div id="pro-fields" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid #ccc;">
                                        <div class="form-group">
                                            <label data-i18n="company_name_label">Nom de l'entreprise *</label>
                                            <input type="text" id="company-name" data-i18n-placeholder="company_name_placeholder" placeholder="Nom de l'entreprise" autocomplete="off" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1em;">
                                        </div>
                                        <div class="form-group">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                                <div>
                                                    <label data-i18n="siret_label">SIRET (Optionnel)</label>
                                                    <input type="text" id="company-siret" data-i18n-placeholder="siret_placeholder" placeholder="SIRET" autocomplete="off" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1em;">
                                                </div>
                                                <div>
                                                    <label data-i18n="tva_label">Numéro de TVA (Optionnel)</label>
                                                    <input type="text" id="company-tva" data-i18n-placeholder="tva_placeholder" placeholder="TVA Intracom" autocomplete="off" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1em;">
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Adresse de facturation (3 champs séparés comme l'adresse de livraison) -->
                                        <div id="pro-address-group" style="display: none;">
                                            <div class="form-group">
                                                <label data-i18n="billing_address_label">Adresse postale *</label>
                                                <textarea id="company-address" data-i18n-placeholder="billing_address_placeholder" placeholder="Votre adresse" rows="2" autocomplete="off" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1em; resize: vertical;"></textarea>
                </div>
                <div class="form-group">
                                                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                                    <div>
                                                        <label data-i18n="postal_code_label">Code Postal *</label>
                                                        <input type="text" id="company-postal-code" data-i18n-placeholder="postal_code_placeholder" placeholder="CP" autocomplete="off" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1em;">
                                                    </div>
                                                    <div>
                                                        <label data-i18n="city_label">Ville *</label>
                                                        <input type="text" id="company-city" placeholder="Ville" autocomplete="off" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1em;">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <button type="submit" class="btn" id="submit-btn" data-i18n="submit_order_btn" style="margin-top: 20px;">Valider la commande</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Custom Modal pour alerts et confirms -->
    <div id="custom-modal-overlay" class="custom-modal-overlay">
        <div class="custom-modal">
            <div id="custom-modal-icon" class="custom-modal-icon"></div>
            <div id="custom-modal-title" class="custom-modal-title"></div>
            <div id="custom-modal-message" class="custom-modal-message"></div>
            <div id="custom-modal-buttons" class="custom-modal-buttons"></div>
        </div>
    </div>
    
    <!-- Promotions Modal -->
    <div id="promotions-modal" class="cart-modal">
        <div class="cart-modal-dialog" style="max-width: 1200px;">
            <div class="cart">
                <div class="cart-header">
                    <h2 data-i18n="promotions_title">Nos offres</h2>
                    <button onclick="document.getElementById('promotions-modal').classList.remove('active'); document.body.classList.remove('modal-open');" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">&times;</button>
                </div>
                <div style="padding: 20px; max-height: calc(100vh - 150px); overflow-y: auto;">
                    <div id="promotions-modal-list" class="promotions-list"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tutorial Modal -->
    <div id="tutorial-modal" class="cart-modal">
        <div class="cart-modal-dialog" style="max-width: 1200px;">
            <div class="cart">
                <div class="cart-header">
                    <h2 data-i18n="tutorial_title">Comment utiliser la borne</h2>
                    <button onclick="document.getElementById('tutorial-modal').classList.remove('active'); document.body.classList.remove('modal-open');" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">&times;</button>
                </div>
                <div style="padding: 20px; max-height: calc(100vh - 150px); overflow-y: auto;">
                    <div id="tutorial-modal-content" class="tutorial-content"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Pack Selection Modal -->
    <div id="pack-modal" class="cart-modal">
        <div class="cart-modal-dialog" style="max-width: 480px;">
            <div class="cart">
                <div class="cart-header">
                    <h2 data-i18n="pack_modal_title">Pack Photos</h2>
                    <button onclick="document.getElementById('pack-modal').classList.remove('active')" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">&times;</button>
                </div>
                <div style="padding: 20px;">
                    <p style="color: #666; margin-bottom: 20px;" data-i18n="pack_modal_description">Achetez toutes vos photos d'un coup avec le pack.</p>
                    <div id="pack-list" style="display: flex; flex-direction: column; gap: 15px; max-height: 60vh; overflow-y: auto; padding-right: 10px;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Configuration API pour frontend hébergé
        window.API_BASE = null; // Mode statique : pas d'API backend
        window.API_KEY = null;
        // Configuration R2 pour photos WebP (uniquement pour interface online)
        window.R2_PUBLIC_URL = 'https://galerie.smarttrailerapp.com';
        // Endpoint public Infomaniak pour envoyer les commandes vers R2
        // Cet endpoint sera créé côté serveur Infomaniak (PHP/Node) qui écrit dans R2
        window.PUBLIC_API_URL = '/api/orders/snapshot'; // À configurer selon votre serveur Infomaniak
    </script>
    <script src="/static/js/client_base.js?v=9"></script>
    <script src="/static/js/client_online.js?v=1"></script>
</body>
</html>
    